<!--
<copyright company="nhantinsoft.vn">
 Author: Mr.Hiep
 Created Date: 10/10/2017
</copyright>
-->

<div class='content-wrapper' ng-init="app.settings.pagetitle = 'Thống kê vào ra của từng người theo thời gian';">
    <section class="box">
        <header class="panel_header">
            <h2 class="title pull-left">Tìm kiếm</h2>
            <div class="actions panel_actions pull-right">
                <i class="box_toggle material-icons">expand_less</i>
            </div>
        </header>
        <div class="content-body">
            <form name="searchForm">
                <div class="row">
                    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3">
                        <div class="form-group">
                            <label class="form-label">Từ ngày<span class='text-danger text-strong'>&nbsp;*</span></label>
                            <div class="controls">
                                <datepicker-full model-date="vm.Model.DateFrom"></datepicker-full>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3">
                        <div class="form-group">
                            <label class="form-label">Từ giờ<span class='text-danger text-strong'>&nbsp;*</span></label>
                            <div class="controls">
                                <input type="text" class="form-control" data-ng-model="vm.Model.TimeFrom" pattern="[0-9]{2}:[0-9]{2}" required maxlength="5">
                            </div>
                        </div>
                    </div>

                    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3">
                        <div class="form-group">
                            <label class="form-label">Tới ngày<span class='text-danger text-strong'>&nbsp;*</span></label>
                            <div class="controls">
                                <datepicker-full model-date="vm.Model.DateTo"></datepicker-full>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3">
                        <div class="form-group">
                            <label class="form-label">Tới giờ<span class='text-danger text-strong'>&nbsp;*</span></label>
                            <div class="controls">
                                <input type="text" class="form-control" data-ng-model="vm.Model.TimeTo" pattern="[0-9]{2}:[0-9]{2}" required maxlength="5">
                            </div>
                        </div>
                    </div>

                </div>

                <div class="row">
                    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3">
                        <div class="form-group">
                            <label class="form-label">Tỉ lệ chính xác từ<span class='text-danger text-strong'>&nbsp;*</span></label>
                            <div class="controls">
                                <input type="text" class="form-control" data-ng-model="vm.Model.ConfidenceFrom" pattern="[0]{1}.[0-9]{2}" required maxlength="4">
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3">
                        <div class="form-group">
                            <label class="form-label">Tỉ lệ chính xác đến<span class='text-danger text-strong'>&nbsp;*</span></label>
                            <div class="controls">
                                <input type="text" class="form-control" data-ng-model="vm.Model.ConfidenceTo" pattern="[0]{1}.[0-9]{2}" required maxlength="4">
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3">
                        <div class="form-group">
                            <label class="form-label">IP Camera</label>
                            <div class="controls">
                                <input type="text" class="form-control" data-ng-model="vm.Model.CameraIPAddress">
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-2 col-lg-2">
                        <div class="form-group">
                            <label class="form-label">Số khuôn mặt</label>
                            <div class="controls">
                                <input type="text" class="form-control" data-ng-model="vm.Model.FaceCount">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-6 col-md-3 col-sm-6 col-lg-3">
                        <div class="form-group form-group-custom">
                            <label class="form-label">Phòng ban: <span class='text-danger text-strong'>&nbsp;*</span></label>
                            <div class="controls">
                                <select class="form-control" data-ng-model="vm.Model.DepartmentId"
                                        data-ng-options="unit.DepartmentId as unit.Name for unit in vm.ListDepartment">
                                    <option value="">&lt;&lt; Tất cả &gt;&gt;</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3">
                        <div class="form-group">
                            <label class="form-label">Mã nhân viên</label>
                            <div class="controls">
                                <input type="text" class="form-control" data-ng-model="vm.Model.EmployeeCode">
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3">
                        <div class="form-group">
                            <label class="form-label">Họ tên</label>
                            <div class="controls">
                                <input type="text" class="form-control" data-ng-model="vm.Model.EmployeeName">
                            </div>
                        </div>
                    </div>

                 

                    <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3 text-right margin-top-15">
                        <button class="btn btn-success" type="submit" ng-click="vm.FnSearch()">
                            <i class="fa fa-search"></i> &nbsp;<span>Tìm kiếm</span>
                        </button>
                        <button class="btn btn-default" ng-click="vm.FnClear()">
                            <i class="fa fa-refresh"></i> &nbsp;<span>Làm mới</span>
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </section>

    <section class="box ">
        <header class="panel_header">
            <h2 class="title pull-left">Danh sách vào ra</h2>
            <div class="actions panel_actions pull-right">
                <i class="box_toggle material-icons">expand_more</i>
            </div>
        </header>
        <div class="content-body">
            <div class="row margin-bottom-5">
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 text-left">
                    <label class="form-label">Tổng số <span class="bold text-danger">{{totalItems}}</span> lượt vào ra</label>
                </div>
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 text-right">
                    <!--<button type="button" class="btn btn-danger" ng-click="vm.FnTraining()">
                        <i class="fa fa-picture-o" aria-hidden="true"></i> &nbsp;<span>Training ảnh</span>
                    </button>-->
                    <button type="button" class="btn btn-success" ng-click="vm.ExportExcel()">
                        <i class="fa fa-file-excel-o"></i> &nbsp;<span>Xuất EXCEL</span>
                    </button>
                </div>

            </div>
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                    <perfect-scrollbar wheel-propagation="true" suppress-scroll-y="true" min-scrollbar-length="20" class='ps-scrollbar'>
                        <table class="table table-bordered table-hover table-sorting" style="min-width:1270px">
                            <thead>
                                <tr ng-init="FnSearchPub = vm.FnSearch">
                                    <!--<th width="50px" class="text-center">Chọn</th>-->
                                    <th width="50px" class="text-center">STT</th>
                                    <th class="text-center" width="130px">Xử lý</th>
                                    <th width="90px" class="text-center">Khuôn mặt</th>
                                    <th width="90px" class="text-center">Ảnh</th>
                                    <th sort callback-fn="FnSearchPub({by:'EmployeeCode',type:reverse})" width="110px">Mã nhân viên</th>
                                    <th sort callback-fn="FnSearchPub({by:'EmployeeName',type:reverse})" width="160px">Họ và tên</th>
                                    <th sort callback-fn="FnSearchPub({by:'DepartmentName',type:reverse})" width="140px">Chức vụ</th>
                                    <th sort callback-fn="FnSearchPub({by:'DepartmentName',type:reverse})">Phòng ban</th>
                                    <th sort callback-fn="FnSearchPub({by:'Date',type:reverse})" width="140px">Thời gian</th>
                                    <th sort callback-fn="FnSearchPub({by:'Confidence',type:reverse})" width="115px">Tỉ lệ chính xác</th>
                                    <th sort callback-fn="FnSearchPub({by:'CameraIPAddress',type:reverse})" width="120px">IP Camera</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="row in vm.ListResult">
                                    <!--<td width="50px" class="text-center">
        <input type="checkbox" ng-model="row.ObjSelect" style="width:16px"/>
    </td>-->
                                    <td class="text-center">{{StartIndex + ($index+1)}}</td>
                                    <td style="text-align:center">
                                        <button type="button" ng-disabled="row.ImageLink==''" ng-click="vm.FnTraining(ServiceBase,row)" class="btn btn-sm btn-success" title="Training ảnh">
                                            <i class="fa fa-picture-o" aria-hidden="true"></i>
                                        </button>
                                        <button type="button" ng-click="vm.FnShowUpdate(row.AttendanceLogId)" class="btn btn-sm btn-warning" title="Cập nhật">
                                            <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                                        </button>
                                        <button type="button" ng-click="vm.FnDelete(row.AttendanceLogId)" class="btn btn-sm btn-danger" title="Xóa">
                                            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                        </button>
                                    </td>
                                    <td class="text-center"><img ng-click="vm.FnShowImage(ServiceBase+row.ImageFace,row.EmployeeCode,row.EmployeeName,row.Date,row.JobTitleName)" ng-if="row.ImageFace!=''" ng-src="{{ServiceBase}}{{row.ImageFace}}" style="max-height:42px;max-width:55px;" /></td>
                                    <td class="text-center"><img ng-click="vm.FnShowImage(ServiceBase+row.ImageLink,row.EmployeeCode,row.EmployeeName,row.Date,row.JobTitleName)" ng-if="row.ImageLink!=''" ng-src="{{ServiceBase}}{{row.ImageLink}}" style="max-height:42px;max-width:55px;" /></td>
                                    <td>{{row.EmployeeCode}}</td>
                                    <td>{{row.EmployeeName}}</td>
                                    <td>{{row.JobTitleName}}</td>
                                    <td>{{row.DepartmentName}}</td>
                                    <td>{{row.Date | date:'dd/MM/yyyy HH:mm:ss'}}</td>
                                    <td>{{row.Confidence}}</td>
                                    <td>{{row.CameraIPAddress}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </perfect-scrollbar>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 ">
                    <span class="form-label-custom">
                        Số bản ghi/trang:
                    </span>
                    <select style="width:120px" class="form-control" data-ng-model="vm.Model.PageSize" data-ng-options="unit.Id as unit.Name for unit in vm.ListPageSize" ng-change="vm.FnSearch()"></select>
                </div>
                <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8 " ng-show="totalItems>vm.Model.PageSize">
                    <pagination ng-change="vm.FnSearch()" total-items="totalItems" ng-model="currentPage" max-size="maxSize" class="pagination-sm" boundary-links="true" items-per-page="vm.Model.PageSize"></pagination>
                </div>
            </div>
            <hr class="margin-top-10; margin-bottom-10" />
        </div>
    </section>
</div>
